ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
View(ageg_region)
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(region_group= group_by_if(sum(n))) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(region_group = sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(region_group = n) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(region_group= group_by(sum(n))) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(region_group= group_by(sum(n))) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(region_group = sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
ageg_region_two
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
ageg_region_two
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
ggplot(data=ageg_region,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n))
ageg_region_two
ageg_region_three <- left_join(ageg_region,ageg_region_two,id ="region")
View(ageg_region_three)
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
ageg_region
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
ageg_region
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region_two
ageg_region_three <- left_join(ageg_region,ageg_region_two,id ="region")
ggplot(data=ageg_region,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
ggplot(data=ageg_region_three,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
ageg_region_three
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region_two
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(n = n()) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region_two
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n))
ageg_region
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n))
ageg_region
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region_two
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(region_group = sum(n)) %>%
mutate(tot_group= sum(n))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(region_group = region$sum(n)) %>%
mutate(tot_group= sum(n))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n))
ageg_region
ageg_region_two <- ageg_region %>%
filter(!is.na(region)) %>%
group_by(region) %>%
summarise(region_group = sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(region, region_group = sum(n)) %>%
mutate(tot_group= sum(n))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(region, region_group = sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise_each(region, region_group = sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise_each(region_n = sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise_each(region_n = n()) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise_each(region_n = n()) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise_each(region_n = n()) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise_each(group_by(region),region_group =sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise_each(group_by(region),region_group =sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(group_by(region),region_group =sum(n)) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/region_group*100,1))
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
summarise(mean_sql = mean(n))  %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
religion_marriage <- welfare %>%
filter(!is.na(group_marriage)) %>%
count(religion,group_marriage) %>%
group_by(religion) %>%
mutate(pct = round(n/sum(n)*100,1))
#이혼율 표만들기
#이혼 추출
divorce <- religion_marriage %>%
filter(group_marriage == "divorce") %>%
select(religion,pct)
#그래프
ggplot(data=divorce,aes(x=religion,y=pct))+geom_col()
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
View(religion_marriage)
religion_marriage
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
summarise(n = n()) %>%
count(region) %>%
group_by(region)
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
group_by(ageg,region) %>%
count(region) %>%
group_by(region)
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
count(region) %>%
group_by(ageg,region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
count(region) %>%
group_by(ageg,region) %>%
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
count(region) %>%
group_by(ageg,region)
ageg_region
ageg_region <- welfaretwo %>%
filter(!is.na(region)) %>%
count(region) %>%
group_by(ageg,region)
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
welfaretwo %>%
filter(!is.na(code_region)) %>%
select(code_region,region) %>%
head
qplot(welfaretwo$region)
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
ageg_region_three <- left_join(ageg_region,ageg_region_two,id ="region")
ageg_region_three
ggplot(data=ageg_region_three,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
ggplot(data=ageg_region,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
welfaretwo %>%
filter(!is.na(code_region)) %>%
select(code_region,region) %>%
head
qplot(welfaretwo$region)
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,1))
ageg_region
ggplot(data=ageg_region,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,2))
ageg_region
welfaretwo %>%
filter(!is.na(code_region)) %>%
select(code_region,region) %>%
head
qplot(welfaretwo$region)
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,2))
ageg_region
welfaretwo %>%
filter(!is.na(code_region)) %>%
select(code_region,region) %>%
head
qplot(welfaretwo$region)
ageg_region <- welfare %>%
count(region,ageg) %>%
group_by(region) %>%
mutate(pct =round(n/sum(n)*100,2))
ageg_region <- welfaretwo %>%
count(region,ageg) %>%
group_by(region) %>%
mutate(pct =round(n/sum(n)*100,2))
ggplot(data=ageg_region,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
ageg_region
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
count(region) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,2))
ageg_region
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,2))
ageg_region <- welfaretwo %>%
count(region,ageg) %>%
group_by(region) %>%
mutate(pct =round(n/sum(n)*100,2))
ageg_region <- welfaretwo %>%
group_by(region,ageg) %>%
summarise(n = n()) %>%
mutate(tot_group= sum(n)) %>%
mutate(pct=round(n/tot_group*100,2))
ageg_region
list_order_old <- ageg_region %>%
filter (ageg == "old") %>%
arrange(pct)
list_order_old
ggplot(data=list_order_old,aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()
order <- list_order_old$region
order
ggplot(data =ageg_region, aes(x=region,y=pct,fill=ageg))+geom_col+coord_flip()+scale_x_discrete(limite=order)
ggplot(data =ageg_region, aes(x=region,y=pct,fill=ageg))+geom_col+coord_flip()+scale_x_discrete(limite=order)
ggplot(data =ageg_region, aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()+scale_x_discrete(limite=order)
ggplot(data =ageg_region, aes(x=region,y=pct,fill=ageg))+geom_col()+coord_flip()+scale_x_discrete(limits=order)
install.packages("devtools")
library(devtools)
install_github('dkahle/ggmap')
station_data <-read.csv("역별_주소_및_전화번호.csv")
str(station_data)
station_code <- as.character(station_data$구주소)
googleAPIkey <-AIzaSyB1humNpbDUSfetqIOqGRYmJVKxlGbGuzQ
googleAPIkey <-"AIzaSyB1humNpbDUSfetqIOqGRYmJVKxlGbGuzQ"
register_google(googleAPIkey)
str(station_data)
station_code <- as.character(station_data$구주소)
register_google(googleAPIkey)
install_github('dkahle/ggmap')
install.packages("ggmap")
library(ggmap)
register_google(googleAPIkey)
head(station_code)
head(station_code)
register_google(googleAPIkey)
station_code <-geocode(station_code)
head(station_code)
head(station_code)
View(station_data)
View(station_code)
register_google(googleAPIkey)
station_code <-geocode(station_code)
head(station_code)
googleAPIkey <-"AIzaSyB1humNpbDUSfetqIOqGRYmJVKxlGbGuzQ"
register_google(googleAPIkey)
station_code <-geocode(station_code)
library(ggmap)
library(dplyr)
library(devtools)
install_github('dkahle/ggmap')
1
station_data <-read.csv("역별_주소_및_전화번호.csv")
str(station_data)
station_code <- as.character(station_data$구주소)
googleAPIkey <-"AIzaSyB1humNpbDUSfetqIOqGRYmJVKxlGbGuzQ"
register_google(googleAPIkey)
station_code <-geocode(station_code)
head(station_code)
googleAPIkey <-"AIzaSyB1humNpbDUSfetqIOqGRYmJVKxlGbGuzQ"
register_google(googleAPIkey)
station_code <-geocode(station_code)
head(station_code)
head(station_code)
googleAPIkey <-"AIzaSyB1humNpbDUSfetqIOqGRYmJVKxlGbGuzQ"
register_google(googleAPIkey)
station_code <-geocode(station_code)
head(station_code)
library(ggmap)
library(dplyr)
station_data <-read.csv("역별_주소_및_전화번호.csv")
str(station_data)
station_code <- as.character(station_data$구주소)
googleAPIkey <-"AIzaSyB1humNpbDUSfetqIOqGRYmJVKxlGbGuzQ"
register_google(googleAPIkey)
station_code <-geocode(station_code)
head(station_code)
googleAPIkey <-"AIzaSyCL_4b3Ieb0232eScJvuBapxF9R501PwBE"
register_google(googleAPIkey)
station_code <-geocode(station_code)
head(station_code)
googleAPIkey <-"AIzaSyDrukGXGw3S_tIfEFMvdpaOVcI9FVzvXUY"
register_google(googleAPIkey)
station_code <-geocode(station_code)
